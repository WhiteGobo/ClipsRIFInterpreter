@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rif: <http://www.w3.org/2007/rif#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .

<http://example.com/expand-implies> a rif:Forall ;
    rif:formula [ a rif:Implies ;
            rif:if [ a rif:And ;
                    rif:formulas ( [ a rif:Frame ;
                                rif:object [ a rif:Var ;
                                        rif:varname "outerrule" ] ;
                                rif:slots ( [ a rif:Slot ;
                                            rif:slotkey [ a rif:Const ;
                                                    rif:constIRI "http://www.w3.org/1999/02/22-rdf-syntax-ns#type"^^xsd:anyURI ] ;
                                            rif:slotvalue [ a rif:Const ;
                                                    rif:constIRI "http://www.w3.org/2007/rif#Forall"^^xsd:anyURI ] ] ) ] [ a rif:Frame ;
                                rif:object [ a rif:Var ;
                                        rif:varname "outerrule" ] ;
                                rif:slots ( [ a rif:Slot ;
                                            rif:slotkey [ a rif:Const ;
                                                    rif:constIRI "http://www.w3.org/2007/rif#formula"^^xsd:anyURI ] ;
                                            rif:slotvalue [ a rif:Var ;
                                                    rif:varname "implies" ] ] ) ] [ a rif:Frame ;
                                rif:object [ a rif:Var ;
                                        rif:varname "implies" ] ;
                                rif:slots ( [ a rif:Slot ;
                                            rif:slotkey [ a rif:Const ;
                                                    rif:constIRI "http://www.w3.org/1999/02/22-rdf-syntax-ns#type"^^xsd:anyURI ] ;
                                            rif:slotvalue [ a rif:Const ;
                                                    rif:constIRI "http://www.w3.org/2007/rif#Implies"^^xsd:anyURI ] ] ) ] [ a rif:Frame ;
                                rif:object [ a rif:Var ;
                                        rif:varname "implies" ] ;
                                rif:slots ( [ a rif:Slot ;
                                            rif:slotkey [ a rif:Const ;
                                                    rif:constIRI "http://www.w3.org/2007/rif#if"^^xsd:anyURI ] ;
                                            rif:slotvalue [ a rif:Var ;
                                                    rif:varname "formula" ] ] ) ] [ a rif:Frame ;
                                rif:object [ a rif:Var ;
                                        rif:varname "implies" ] ;
                                rif:slots ( [ a rif:Slot ;
                                            rif:slotkey [ a rif:Const ;
                                                    rif:constIRI "http://www.w3.org/2007/rif#then"^^xsd:anyURI ] ;
                                            rif:slotvalue [ a rif:Var ;
                                                    rif:varname "action" ] ] ) ] ) ] ;
            rif:then [ a rif:Do ;
                    rif:actions ( [ a rif:Assert ;
                                rif:target [ a rif:Frame ;
                                        rif:object [ a rif:Var ;
                                                rif:varname "outerrule" ] ;
                                        rif:slots ( [ a rif:Slot ;
                                                    rif:slotkey [ a rif:Const ;
                                                            rif:constIRI "http://www.w3.org/2007/rif#pattern"^^xsd:anyURI ] ;
                                                    rif:slotvalue [ a rif:Var ;
                                                            rif:varname "formula" ] ] ) ] ] [ a rif:Modify ;
                                rif:target [ a rif:Frame ;
                                        rif:object [ a rif:Var ;
                                                rif:varname "outerrule" ] ;
                                        rif:slots ( [ a rif:Slot ;
                                                    rif:slotkey [ a rif:Const ;
                                                            rif:constIRI "http://www.w3.org/2007/rif#formula"^^xsd:anyURI ] ;
                                                    rif:slotvalue [ a rif:Var ;
                                                            rif:varname "action" ] ] ) ] ] [ a rif:Retract ;
                                rif:target [ a rif:Var ;
                                        rif:varname "implies" ] ] ) ] ] ;
    rif:vars ( [ a rif:Var ;
                rif:varname "implies" ] [ a rif:Var ;
                rif:varname "outerrule" ] [ a rif:Var ;
                rif:varname "pattern" ] [ a rif:Var ;
                rif:varname "action" ] ) .

<http://example.com/move-action-outwards> a rif:Forall ;
    rif:formula [ a rif:Implies ;
            rif:if [ a rif:And ;
                    rif:formulas ( [ a rif:Frame ;
                                rif:object [ a rif:Var ;
                                        rif:varname "outerrule" ] ;
                                rif:slots ( [ a rif:Slot ;
                                            rif:slotkey [ a rif:Const ;
                                                    rif:constIRI "http://www.w3.org/1999/02/22-rdf-syntax-ns#type"^^xsd:anyURI ] ;
                                            rif:slotvalue [ a rif:Const ;
                                                    rif:constIRI "http://www.w3.org/2007/rif#Forall"^^xsd:anyURI ] ] ) ] [ a rif:Frame ;
                                rif:object [ a rif:Var ;
                                        rif:varname "innerrule" ] ;
                                rif:slots ( [ a rif:Slot ;
                                            rif:slotkey [ a rif:Const ;
                                                    rif:constIRI "http://www.w3.org/1999/02/22-rdf-syntax-ns#type"^^xsd:anyURI ] ;
                                            rif:slotvalue [ a rif:Const ;
                                                    rif:constIRI "http://www.w3.org/2007/rif#Forall"^^xsd:anyURI ] ] ) ] [ a rif:Frame ;
                                rif:object [ a rif:Var ;
                                        rif:varname "outerrule" ] ;
                                rif:slots ( [ a rif:Slot ;
                                            rif:slotkey [ a rif:Const ;
                                                    rif:constIRI "http://www.w3.org/2007/rif#formula"^^xsd:anyURI ] ;
                                            rif:slotvalue [ a rif:Var ;
                                                    rif:varname "innerrule" ] ] ) ] [ a rif:Frame ;
                                rif:object [ a rif:Var ;
                                        rif:varname "innerrule" ] ;
                                rif:slots ( [ a rif:Slot ;
                                            rif:slotkey [ a rif:Const ;
                                                    rif:constIRI "http://www.w3.org/2007/rif#formula"^^xsd:anyURI ] ;
                                            rif:slotvalue [ a rif:Var ;
                                                    rif:varname "action" ] ] ) ] [ a rif:INeg ;
                                rif:formula [ a rif:Exists ;
                                        rif:formula [ a rif:Frame ;
                                                rif:object [ a rif:Var ;
                                                        rif:varname "innerrule" ] ;
                                                rif:slots ( [ a rif:Slot ;
                                                            rif:slotkey [ a rif:Const ;
                                                                    rif:constIRI "http://www.w3.org/2007/rif#pattern"^^xsd:anyURI ] ;
                                                            rif:slotvalue [ a rif:Var ;
                                                                    rif:varname "pattern" ] ] ) ] ;
                                        rif:vars ( [ a rif:Var ;
                                                    rif:varname "pattern" ] ) ] ] ) ] ;
            rif:then [ a rif:Do ;
                    rif:actions ( [ a rif:Assert ;
                                rif:target [ a rif:Frame ;
                                        rif:object [ a rif:Var ;
                                                rif:varname "outerrule" ] ;
                                        rif:slots ( [ a rif:Slot ;
                                                    rif:slotkey [ a rif:Const ;
                                                            rif:constIRI "http://www.w3.org/2007/rif#formula"^^xsd:anyURI ] ;
                                                    rif:slotvalue [ a rif:Var ;
                                                            rif:varname "action" ] ] ) ] ] [ a rif:Retract ;
                                rif:target [ a rif:Var ;
                                        rif:varname "innerrule" ] ] ) ] ] ;
    rif:vars ( [ a rif:Var ;
                rif:varname "innerrule" ] [ a rif:Var ;
                rif:varname "outerrule" ] [ a rif:Var ;
                rif:varname "action" ] ) .

<http://example.com/move-pattern-outwards> a rif:Forall ;
    rif:formula [ a rif:Implies ;
            rif:if [ a rif:And ;
                    rif:formulas ( [ a rif:Frame ;
                                rif:object [ a rif:Var ;
                                        rif:varname "outerrule" ] ;
                                rif:slots ( [ a rif:Slot ;
                                            rif:slotkey [ a rif:Const ;
                                                    rif:constIRI "http://www.w3.org/1999/02/22-rdf-syntax-ns#type"^^xsd:anyURI ] ;
                                            rif:slotvalue [ a rif:Const ;
                                                    rif:constIRI "http://www.w3.org/2007/rif#Forall"^^xsd:anyURI ] ] ) ] [ a rif:Frame ;
                                rif:object [ a rif:Var ;
                                        rif:varname "innerrule" ] ;
                                rif:slots ( [ a rif:Slot ;
                                            rif:slotkey [ a rif:Const ;
                                                    rif:constIRI "http://www.w3.org/1999/02/22-rdf-syntax-ns#type"^^xsd:anyURI ] ;
                                            rif:slotvalue [ a rif:Const ;
                                                    rif:constIRI "http://www.w3.org/2007/rif#Forall"^^xsd:anyURI ] ] ) ] [ a rif:Frame ;
                                rif:object [ a rif:Var ;
                                        rif:varname "outerrule" ] ;
                                rif:slots ( [ a rif:Slot ;
                                            rif:slotkey [ a rif:Const ;
                                                    rif:constIRI "http://www.w3.org/2007/rif#formula"^^xsd:anyURI ] ;
                                            rif:slotvalue [ a rif:Var ;
                                                    rif:varname "innerrule" ] ] ) ] [ a rif:Frame ;
                                rif:object [ a rif:Var ;
                                        rif:varname "innerrule" ] ;
                                rif:slots ( [ a rif:Slot ;
                                            rif:slotkey [ a rif:Const ;
                                                    rif:constIRI "http://www.w3.org/2007/rif#pattern"^^xsd:anyURI ] ;
                                            rif:slotvalue [ a rif:Var ;
                                                    rif:varname "pattern" ] ] ) ] ) ] ;
            rif:then [ a rif:Do ;
                    rif:actions ( [ a rif:Retract ;
                                rif:target [ a rif:Frame ;
                                        rif:object [ a rif:Var ;
                                                rif:varname "innerrule" ] ;
                                        rif:slots ( [ a rif:Slot ;
                                                    rif:slotkey [ a rif:Const ;
                                                            rif:constIRI "http://www.w3.org/2007/rif#pattern"^^xsd:anyURI ] ;
                                                    rif:slotvalue [ a rif:Var ;
                                                            rif:varname "pattern" ] ] ) ] ] [ a rif:Assert ;
                                rif:target [ a rif:Frame ;
                                        rif:object [ a rif:Var ;
                                                rif:varname "outerrule" ] ;
                                        rif:slots ( [ a rif:Slot ;
                                                    rif:slotkey [ a rif:Const ;
                                                            rif:constIRI "http://www.w3.org/2007/rif#pattern"^^xsd:anyURI ] ;
                                                    rif:slotvalue [ a rif:Var ;
                                                            rif:varname "pattern" ] ] ) ] ] ) ] ] ;
    rif:vars ( [ a rif:Var ;
                rif:varname "innerrule" ] [ a rif:Var ;
                rif:varname "outerrule" ] [ a rif:Var ;
                rif:varname "pattern" ] ) .

<http://example.com/normalize-rules> a rif:Group ;
    rif:behavior [ rif:Priority 90 ] ;
    rif:sentences ( <http://example.com/move-pattern-outwards> <http://example.com/move-action-outwards> <http://example.com/expand-implies> ) .

[] a rif:Document ;
    rif:payload <http://example.com/normalize-rules> .

