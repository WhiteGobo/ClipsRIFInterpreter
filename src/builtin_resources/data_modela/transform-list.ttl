@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rif: <http://www.w3.org/2007/rif#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .

<http://example.com/triples-to-rdf#combine-rdf-lists> a rif:Group ;
    rif:behavior [ rif:Priority 100 ] ;
    rif:sentences ( [ a rif:Forall ;
                rif:formula [ a rif:Implies ;
                        rif:if [ a rif:And ;
                                rif:formulas ( [ a rif:Frame ;
                                            rif:object [ a rif:Var ;
                                                    rif:varname "base" ] ;
                                            rif:slots ( [ a rif:Slot ;
                                                        rif:slotkey [ a rif:Var ;
                                                                rif:varname "prop" ] ;
                                                        rif:slotvalue [ a rif:Const ;
                                                                rif:constIRI "http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"^^xsd:anyURI ] ] ) ] ) ] ;
                        rif:then [ a rif:Do ;
                                rif:actions ( [ a rif:Retract ;
                                            rif:target [ a rif:Frame ;
                                                    rif:object [ a rif:Var ;
                                                            rif:varname "base" ] ;
                                                    rif:slots ( [ a rif:Slot ;
                                                                rif:slotkey [ a rif:Var ;
                                                                        rif:varname "prop" ] ;
                                                                rif:slotvalue [ a rif:Const ;
                                                                        rif:constIRI "http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"^^xsd:anyURI ] ] ) ] ] [ a rif:Assert ;
                                            rif:target [ a rif:Frame ;
                                                    rif:object [ a rif:Var ;
                                                            rif:varname "base" ] ;
                                                    rif:slots ( [ a rif:Slot ;
                                                                rif:slotkey [ a rif:Var ;
                                                                        rif:varname "prop" ] ;
                                                                rif:slotvalue [ a rif:List ;
                                                                        rif:items () ] ] ) ] ] ) ] ] ;
                rif:vars ( [ a rif:Var ;
                            rif:varname "base" ] [ a rif:Var ;
                            rif:varname "prop" ] ) ] [ a rif:Forall ;
                rif:formula [ a rif:Implies ;
                        rif:if [ a rif:And ;
                                rif:formulas ( [ a rif:Frame ;
                                            rif:object [ a rif:Var ;
                                                    rif:varname "base" ] ;
                                            rif:slots ( [ a rif:Slot ;
                                                        rif:slotkey [ a rif:Const ;
                                                                rif:constIRI "http://example.com/triples-to-rdf#as-list"^^xsd:anyURI ] ;
                                                        rif:slotvalue [ a rif:Var ;
                                                                rif:varname "list" ] ] ) ] [ a rif:INeg ;
                                            rif:formula [ a rif:Exists ;
                                                    rif:formula [ a rif:Frame ;
                                                            rif:object [ a rif:Var ;
                                                                    rif:varname "s" ] ;
                                                            rif:slots ( [ a rif:Slot ;
                                                                        rif:slotkey [ a rif:Var ;
                                                                                rif:varname "p" ] ;
                                                                        rif:slotvalue [ a rif:Var ;
                                                                                rif:varname "base" ] ] ) ] ;
                                                    rif:vars ( [ a rif:Var ;
                                                                rif:varname "s" ] [ a rif:Var ;
                                                                rif:varname "p" ] ) ] ] ) ] ;
                        rif:then [ a rif:Do ;
                                rif:actions ( [ a rif:Retract ;
                                            rif:target [ a rif:Frame ;
                                                    rif:object [ a rif:Var ;
                                                            rif:varname "base" ] ;
                                                    rif:slots ( [ a rif:Slot ;
                                                                rif:slotkey [ a rif:Const ;
                                                                        rif:constIRI "http://example.com/triples-to-rdf#as-list"^^xsd:anyURI ] ;
                                                                rif:slotvalue [ a rif:Var ;
                                                                        rif:varname "list" ] ] ) ] ] ) ] ] ;
                rif:vars ( [ a rif:Var ;
                            rif:varname "base" ] [ a rif:Var ;
                            rif:varname "list" ] ) ] [ a rif:Forall ;
                rif:formula [ a rif:Implies ;
                        rif:if [ a rif:And ;
                                rif:formulas ( [ a rif:Frame ;
                                            rif:object [ a rif:Var ;
                                                    rif:varname "base" ] ;
                                            rif:slots ( [ a rif:Slot ;
                                                        rif:slotkey [ a rif:Const ;
                                                                rif:constIRI "http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"^^xsd:anyURI ] ;
                                                        rif:slotvalue [ a rif:Var ;
                                                                rif:varname "rest" ] ] ) ] [ a rif:Frame ;
                                            rif:object [ a rif:Var ;
                                                    rif:varname "base" ] ;
                                            rif:slots ( [ a rif:Slot ;
                                                        rif:slotkey [ a rif:Const ;
                                                                rif:constIRI "http://www.w3.org/1999/02/22-rdf-syntax-ns#first"^^xsd:anyURI ] ;
                                                        rif:slotvalue [ a rif:Var ;
                                                                rif:varname "first" ] ] ) ] [ a rif:External ;
                                            rif:content [ a rif:Atom ;
                                                    rif:args ( [ a rif:Var ;
                                                                rif:varname "rest" ] ) ;
                                                    rif:op [ a rif:Const ;
                                                            rif:constIRI "http://www.w3.org/2007/rif-builtin-predicate#is-list"^^xsd:anyURI ] ] ] ) ] ;
                        rif:then [ a rif:Do ;
                                rif:actions ( [ a rif:Retract ;
                                            rif:target [ a rif:Frame ;
                                                    rif:object [ a rif:Var ;
                                                            rif:varname "base" ] ;
                                                    rif:slots ( [ a rif:Slot ;
                                                                rif:slotkey [ a rif:Const ;
                                                                        rif:constIRI "http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"^^xsd:anyURI ] ;
                                                                rif:slotvalue [ a rif:Var ;
                                                                        rif:varname "rest" ] ] ) ] ] [ a rif:Retract ;
                                            rif:target [ a rif:Frame ;
                                                    rif:object [ a rif:Var ;
                                                            rif:varname "base" ] ;
                                                    rif:slots ( [ a rif:Slot ;
                                                                rif:slotkey [ a rif:Const ;
                                                                        rif:constIRI "http://www.w3.org/1999/02/22-rdf-syntax-ns#first"^^xsd:anyURI ] ;
                                                                rif:slotvalue [ a rif:Var ;
                                                                        rif:varname "first" ] ] ) ] ] [ a rif:Assert ;
                                            rif:target [ a rif:Frame ;
                                                    rif:object [ a rif:Var ;
                                                            rif:varname "base" ] ;
                                                    rif:slots ( [ a rif:Slot ;
                                                                rif:slotkey [ a rif:Const ;
                                                                        rif:constIRI "http://example.com/triples-to-rdf#as-list"^^xsd:anyURI ] ;
                                                                rif:slotvalue [ a rif:External ;
                                                                        rif:content [ a rif:Expr ;
                                                                                rif:args ( [ a rif:Var ;
                                                                                            rif:varname "rest" ] [ a rif:Const ;
                                                                                            rif:value 0 ] [ a rif:Var ;
                                                                                            rif:varname "first" ] ) ;
                                                                                rif:op [ a rif:Const ;
                                                                                        rif:constIRI "http://www.w3.org/2007/rif-builtin-function#insert-before"^^xsd:anyURI ] ] ] ] ) ] ] ) ] ] ;
                rif:vars ( [ a rif:Var ;
                            rif:varname "base" ] [ a rif:Var ;
                            rif:varname "first" ] [ a rif:Var ;
                            rif:varname "rest" ] ) ] [ a rif:Forall ;
                rif:formula [ a rif:Implies ;
                        rif:if [ a rif:And ;
                                rif:formulas ( [ a rif:Frame ;
                                            rif:object [ a rif:Var ;
                                                    rif:varname "subject" ] ;
                                            rif:slots ( [ a rif:Slot ;
                                                        rif:slotkey [ a rif:Var ;
                                                                rif:varname "prop" ] ;
                                                        rif:slotvalue [ a rif:Var ;
                                                                rif:varname "listbase" ] ] ) ] [ a rif:Frame ;
                                            rif:object [ a rif:Var ;
                                                    rif:varname "listbase" ] ;
                                            rif:slots ( [ a rif:Slot ;
                                                        rif:slotkey [ a rif:Const ;
                                                                rif:constIRI "http://example.com/triples-to-rdf#as-list"^^xsd:anyURI ] ;
                                                        rif:slotvalue [ a rif:Var ;
                                                                rif:varname "aslist" ] ] ) ] ) ] ;
                        rif:then [ a rif:Do ;
                                rif:actions ( [ a rif:Retract ;
                                            rif:target [ a rif:Frame ;
                                                    rif:object [ a rif:Var ;
                                                            rif:varname "subject" ] ;
                                                    rif:slots ( [ a rif:Slot ;
                                                                rif:slotkey [ a rif:Var ;
                                                                        rif:varname "prop" ] ;
                                                                rif:slotvalue [ a rif:Var ;
                                                                        rif:varname "listbase" ] ] ) ] ] [ a rif:Assert ;
                                            rif:target [ a rif:Frame ;
                                                    rif:object [ a rif:Var ;
                                                            rif:varname "subject" ] ;
                                                    rif:slots ( [ a rif:Slot ;
                                                                rif:slotkey [ a rif:Var ;
                                                                        rif:varname "prop" ] ;
                                                                rif:slotvalue [ a rif:Var ;
                                                                        rif:varname "aslist" ] ] ) ] ] ) ] ] ;
                rif:vars ( [ a rif:Var ;
                            rif:varname "subject" ] [ a rif:Var ;
                            rif:varname "prop" ] [ a rif:Var ;
                            rif:varname "listbase" ] [ a rif:Var ;
                            rif:varname "aslist" ] ) ] ) .

[] a rif:Document ;
    rif:payload <http://example.com/triples-to-rdf#combine-rdf-lists> .

